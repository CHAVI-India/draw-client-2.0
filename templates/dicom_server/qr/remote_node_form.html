{% extends 'base.html' %}
{% load static %}

{% block title %}{{ page_title }} - DRAW Client{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Page Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">{{ page_title }}</h1>
        <p class="text-gray-600">Configure remote DICOM node connection and capabilities</p>
    </div>

    <!-- Form -->
    <form method="post" class="bg-white rounded-lg shadow-md p-6">
        {% csrf_token %}
        
        {% if form.non_field_errors %}
            <div class="mb-4 p-4 bg-red-50 text-red-700 rounded">
                {{ form.non_field_errors }}
            </div>
        {% endif %}
        
        <div class="space-y-6">
            <!-- Basic Information -->
            <div>
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Basic Information</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Name *</label>
                        {{ form.name }}
                        {% if form.name.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ form.name.errors.0 }}</p>
                        {% endif %}
                        <p class="text-xs text-gray-500 mt-1">{{ form.name.help_text }}</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">AE Title *</label>
                        {{ form.ae_title }}
                        {% if form.ae_title.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ form.ae_title.errors.0 }}</p>
                        {% endif %}
                        <p class="text-xs text-gray-500 mt-1">{{ form.ae_title.help_text }}</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Host *</label>
                        {{ form.host }}
                        {% if form.host.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ form.host.errors.0 }}</p>
                        {% endif %}
                        <p class="text-xs text-gray-500 mt-1">{{ form.host.help_text }}</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Port *</label>
                        {{ form.port }}
                        {% if form.port.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ form.port.errors.0 }}</p>
                        {% endif %}
                        <p class="text-xs text-gray-500 mt-1">{{ form.port.help_text }}</p>
                    </div>
                </div>
            </div>

            <!-- Capabilities -->
            <div>
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Capabilities</h2>
                <div class="space-y-3">
                    <label class="flex items-center space-x-3">
                        {{ form.supports_c_find }}
                        <span class="text-sm font-medium text-gray-700">Supports C-FIND (Query)</span>
                    </label>
                    <label class="flex items-center space-x-3">
                        {{ form.supports_c_move }}
                        <span class="text-sm font-medium text-gray-700">Supports C-MOVE (Retrieve)</span>
                    </label>
                    <label class="flex items-center space-x-3">
                        {{ form.supports_c_get }}
                        <span class="text-sm font-medium text-gray-700">Supports C-GET (Retrieve)</span>
                    </label>
                </div>
            </div>

            <!-- Query/Retrieve Settings -->
            <div>
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Query/Retrieve Settings</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Query/Retrieve Model</label>
                        {{ form.query_retrieve_model }}
                        {% if form.query_retrieve_model.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ form.query_retrieve_model.errors.0 }}</p>
                        {% endif %}
                        <p class="text-xs text-gray-500 mt-1">{{ form.query_retrieve_model.help_text }}</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Move Destination AE</label>
                        {{ form.move_destination_ae }}
                        {% if form.move_destination_ae.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ form.move_destination_ae.errors.0 }}</p>
                        {% endif %}
                        <p class="text-xs text-gray-500 mt-1">{{ form.move_destination_ae.help_text }}</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Timeout (seconds)</label>
                        {{ form.timeout }}
                        {% if form.timeout.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ form.timeout.errors.0 }}</p>
                        {% endif %}
                        <p class="text-xs text-gray-500 mt-1">{{ form.timeout.help_text }}</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Max PDU Size</label>
                        {{ form.max_pdu_size }}
                        {% if form.max_pdu_size.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ form.max_pdu_size.errors.0 }}</p>
                        {% endif %}
                        <p class="text-xs text-gray-500 mt-1">{{ form.max_pdu_size.help_text }}</p>
                    </div>
                </div>
            </div>

            <!-- Status and Description -->
            <div>
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Status and Description</h2>
                <div class="space-y-4">
                    <label class="flex items-center space-x-3">
                        {{ form.is_active }}
                        <span class="text-sm font-medium text-gray-700">Active</span>
                    </label>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                        {{ form.description }}
                        {% if form.description.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ form.description.errors.0 }}</p>
                        {% endif %}
                        <p class="text-xs text-gray-500 mt-1">{{ form.description.help_text }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Form Actions -->
        <div class="flex justify-end space-x-4 mt-8 pt-6 border-t">
            <a href="{% url 'dicom_server:remote_nodes_list' %}" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition">
                Cancel
            </a>
            <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                {{ action }} Node
            </button>
        </div>
    </form>
</div>
{% endblock %}
